<!doctype html>
<html lang="en">
<head>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	
	<link rel="stylesheet" type="text/css" href="main_style.css">
	
	<link rel="shortcut icon" type="image/ico" href="logo.png">
	<link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet">
	
	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	
	<title>Enkelt - Redigerare</title>
	<meta name="author" content="Edvars Busck-Nielsen">
	<meta name="description" content="Enkelts webbredigerare. Skriv och k√∂r Enkelt-program i din webbl√§sare utan att ladda ner n√•got.">
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123148803-4"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
	  	function gtag(){dataLayer.push(arguments);}
	  	gtag('js', new Date());

	  	gtag('config', 'UA-123148803-4');
	</script>
</head>
<body onload="brython()">

    <script type="text/python" src="enkelt.py" crossorigin="anonymous"></script>

    <div class="wrapper" id="wrapper">
		<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
			<a class="navbar-brand" href="logo.png"><img src="logo.png" height="50px" width="auto" alt="Enkelt"> Enkelt</a>
	        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
	            <span class="navbar-toggler-icon"></span>
	        </button>
	
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
		        <ul class="navbar-nav mr-auto">
			        <li class="nav-item">
				        <a class="nav-link" href="https://enkelt.io">Hem</a>
			        </li>
			        <li class="nav-item active">
				        <a class="nav-link" href="#">Redigerare <span class="sr-only">(current)</span></a>
			        </li>
			        <li class="nav-item">
				        <a class="nav-link" href="https://bibliotek.enkelt.io">Bibliotek</a>
			        </li>
		        </ul>
			</div>
		</nav>
	    
	    <br>
	    <div class="container-fluid">
		    <div class="row" id="cardsRow">
		        <div class="card" id="editorCard">
		            <div class="card-body" id="editor">
			            <div class="card-title">
				            <div class="row">
					            <div class="col">
					                <h5 class="card-title">Redigerare</h5>
					            </div>
					            <div class="col">
					                <ul class="nav nav-pills justify-content-end">
					                    <li class="nav-item">
					                        <button id="preExecuteButton" class="btn btn-info" onclick="runCode()">K√∂r (Ctrl+r)</button>
					                        <button id="executeButton" style="display: none;"></button>
					                    </li>
					                </ul>
					            </div>
				            </div>
			                <hr>
			            </div>
		                <div id="input">
		                    <form>
		                        <div class="form-group" id="codeForm">
									<textarea type="text" autocapitalize="off" id="inputCode" onkeyup="new do_resize(this);" cols="20" rows="1" onkeydown="if(event.keyCode===9){var v=this.value,s=this.selectionStart,e=this.selectionEnd;this.value=v.substring(0, s)+'\t'+v.substring(e);this.selectionStart=this.selectionEnd=s+1;return false;}"></textarea>
		                        </div>
		                    </form>
		                </div>
		            </div>
		        </div>
		        <div class="card" id="outputCard">
		            <div class="card-body" id="run">
						<div class="card-title">
							<div class="row">
								<div class="col">
									<h5 class="card-title">Utdata</h5>
								</div>
								<div class="col">
									<ul class="nav nav-pills justify-content-end">
										<li class="nav-item">
											<a class="btn btn-info" style="opacity: 0 !important;"></a>
										</li>
									</ul>
								</div>
							</div>
							<hr>
						</div>
			            <hr>
		                <div id="myLog" style="font-family: monospace; font-size: 25px; margin-top: 5px;">
		                    <div id="consoleText"></div>
		                </div>
		            </div>
			        <div id="mini_footer"><p>&copy; 2020 Edvard Busck-Nielsen</p></div>
		        </div>
		    </div>
	    </div>
    </div>

	<div class="push"></div>
    
    <p id="outputCount" style="display: none;">0</p>
    <p id="old_outputCount" style="display: none;">0</p>
    <p id="tmp_output_holder" style="display: none;"></p>
    
    <script>
	    function do_resize(textbox) {
		    let txt=textbox.value;
		    let cols=textbox.cols;
		
		    let arraytxt=txt.split('\n');
		    let rows=arraytxt.length;
		
		    for (i=0;i<arraytxt.length;i++) {
			    rows += parseInt(arraytxt[i].length / cols);
			    
			    textbox.rows = rows;
		    }
		 }
    </script>
    
    <script>
	    document.onkeyup = function(e) {
		    if (e.ctrlKey && e.which === 82) {
		        runCode();
		    }
		};
	</script>
    
    <script>
        window.console = {
            log: function(str) {
                if (str !== '') {
                	if (str.includes('True')) {
                		str = 'Sant';
	                }
                	if (str.includes('False')) {
                		str = 'Falskt';
	                }
                	if (str.includes('<class \'float\'>')) {
                		str = 'deimaltal';
	                }
                	if (str.includes('<class \'str\'>')) {
                		str = 'str√§ng';
	                }
                	if (str.includes('<class \'int\'>')) {
                		str = 'heltal';
	                }
                	if (str.includes('<class \'list\'>')) {
                		str = 'lista';
	                }
                	if (str.includes('<class \'dict\'>')) {
                		str = 'lexikon';
	                }
                	if (str.includes('<class \'bool\'>')) {
                		str = 'boolesk';
	                }
                	if (str.includes('<class \'NoneType\'>')) {
                		str = 'inget';
	                }
                	
                	if (str.includes('[3J[H[2J')) {
                		document.getElementById('outputCount').innerHTML = '0';
		                document.getElementById('tmp_output_holder').innerHTML = '';
	                } else {
		                document.getElementById('tmp_output_holder').innerHTML = document.getElementById('tmp_output_holder').innerHTML + " *** " + str;
		                document.getElementById('outputCount').innerHTML = Number(document.getElementById('outputCount').innerHTML) + 1;
	                }
                }
            },
            info: function (str) {
	            let tmp = str;
            }
        }
    </script>
    
    <script>
        function runCode() {
        	if (document.getElementById('inputCode').value !== '') {
		        document.getElementById('old_outputCount').innerHTML = document.getElementById('outputCount').innerHTML;
		        document.getElementById('outputCount').innerHTML = '0';
		        document.getElementById('tmp_output_holder').innerHTML = '';
		        document.getElementById("executeButton").click();
		
		        let node = document.getElementById("consoleText");
		
		        node.innerHTML = '';
		
		        let all_output = document.getElementById('tmp_output_holder').innerHTML;
		        let old_output_count = document.getElementById('old_outputCount').innerHTML;
		
		        all_output = all_output.split(" *** ");
		
		        for (i = 0; i < all_output.length; i++) {
			        if (i > old_output_count) {
				        node.appendChild(document.createElement('BR'));
				        node.appendChild(document.createTextNode(all_output[i]));
				        document.getElementById("myLog").appendChild(node);
			        }
		        }
	        }
        }
    </script>
    
    <script src="brython/brython.js"></script>
	<script src="brython/brython_stdlib.js"></script>


<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>
</html>
